<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libvisual: lv_actor.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">libvisual
   &#160;<span id="projectnumber">0.5.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">lv_actor.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lv__actor_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Libvisual - The audio visualisation framework.</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * Copyright (C) 2004, 2005, 2006 Dennis Smit &lt;ds@nerds-incorporated.org&gt;</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Authors: Dennis Smit &lt;ds@nerds-incorporated.org&gt;</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * $Id: lv_actor.c,v 1.39.2.1 2006/03/04 12:32:47 descender Exp $</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment"> * it under the terms of the GNU Lesser General Public License as</span>
<a name="l00011"></a>00011 <span class="comment"> * published by the Free Software Foundation; either version 2.1</span>
<a name="l00012"></a>00012 <span class="comment"> * of the License, or (at your option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00015"></a>00015 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00017"></a>00017 <span class="comment"> * GNU Lesser General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * You should have received a copy of the GNU Lesser General Public License</span>
<a name="l00020"></a>00020 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00021"></a>00021 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;config.h&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="lv__actor_8h.html">lv_actor.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="lv__common_8h.html">lv_common.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="lv__plugin__registry_8h.html">lv_plugin_registry.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;gettext.h&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;functional&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">namespace </span>{
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a>00037   <span class="keyword">inline</span> LV::PluginList <span class="keyword">const</span>&amp;
<a name="l00038"></a>00038   get_actor_plugin_list ()
<a name="l00039"></a>00039   {
<a name="l00040"></a>00040       <span class="keywordflow">return</span> LV::PluginRegistry::instance()-&gt;get_plugins_by_type (<a class="code" href="group__VisPlugin.html#gga036741cb706f3d4b89b033f97c9e7e23ad23141bba09fd94af2d79733626f2a66">VISUAL_PLUGIN_TYPE_ACTOR</a>);
<a name="l00041"></a>00041   }
<a name="l00042"></a>00042 
<a name="l00043"></a>00043   <span class="keyword">inline</span> <a class="code" href="struct__VisPluginRef.html" title="The VisPluginRef data structure contains information about the plugins and does refcounting.">VisPluginRef</a>*
<a name="l00044"></a>00044   find_actor_plugin (std::string <span class="keyword">const</span>&amp; name)
<a name="l00045"></a>00045   {
<a name="l00046"></a>00046       <span class="keywordflow">return</span> LV::PluginRegistry::instance()-&gt;find_plugin (<a class="code" href="group__VisPlugin.html#gga036741cb706f3d4b89b033f97c9e7e23ad23141bba09fd94af2d79733626f2a66">VISUAL_PLUGIN_TYPE_ACTOR</a>, name);
<a name="l00047"></a>00047   }
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 } <span class="comment">// LV namespace</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="keyword">static</span> <span class="keywordtype">int</span> actor_dtor (<a class="code" href="struct__VisObject.html" title="The VisObject structure contains all the VisObject housekeeping data like refcounting and a pointer t...">VisObject</a> *<span class="keywordtype">object</span>);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="keyword">static</span> <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *get_actor_plugin (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor);
<a name="l00057"></a>00057 <span class="keyword">static</span> <span class="keywordtype">int</span> negotiate_video_with_unsupported_depth (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <span class="keywordtype">int</span> rundepth, <span class="keywordtype">int</span> noevent, <span class="keywordtype">int</span> forced);
<a name="l00058"></a>00058 <span class="keyword">static</span> <span class="keywordtype">int</span> negotiate_video (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <span class="keywordtype">int</span> noevent);
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="keyword">static</span> <span class="keywordtype">int</span> actor_dtor (<a class="code" href="struct__VisObject.html" title="The VisObject structure contains all the VisObject housekeeping data like refcounting and a pointer t...">VisObject</a> *<span class="keywordtype">object</span>)
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062     <a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor = <a class="code" href="group__VisActor.html#ga6345755fda327bdb8cb622a4f0a1a980">VISUAL_ACTOR</a> (<span class="keywordtype">object</span>);
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00065"></a>00065         {
<a name="l00066"></a>00066             <span class="comment">// FIXME: Hack to free songinfo</span>
<a name="l00067"></a>00067             <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin = (<a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *) actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a77f88064c35a26356af60c87b636e169" title="Pointer to the plugin specific data structures.">plugin</a>;
<a name="l00068"></a>00068             <a class="code" href="group__VisSongInfo.html#ga9f1adb2e4205b54d0f2d3f57b6c24062">visual_songinfo_free</a> (actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a>);
<a name="l00069"></a>00069         }
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <a class="code" href="group__VisPlugin.html#ga59e20eb462f5c4afa7c9361d833cb55f" title="Private function to unload a plugin.">visual_plugin_unload</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>);
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00075"></a>00075         <a class="code" href="group__VisPalette.html#ga3f12fa05345a0999bc4cb7773edad605">visual_palette_free</a> (actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a>);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00078"></a>00078         <a class="code" href="group__VisObject.html#gafd90dd70679ecae99a4a55cd605556b6" title="Decreases the reference counter for a VisObject.">visual_object_unref</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>));
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00081"></a>00081         <a class="code" href="group__VisObject.html#gafd90dd70679ecae99a4a55cd605556b6" title="Decreases the reference counter for a VisObject.">visual_object_unref</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a>));
<a name="l00082"></a>00082 
<a name="l00083"></a>00083     <a class="code" href="group__VisSongInfo.html#ga9f1adb2e4205b54d0f2d3f57b6c24062">visual_songinfo_free</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9fcca51f6e0f8e8124dc46601230649b" title="Private member which is used to compare with new songinfo to check if a new song event should be emit...">songcompare</a>);
<a name="l00084"></a>00084 
<a name="l00085"></a>00085     actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00086"></a>00086     actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00087"></a>00087     actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00088"></a>00088 
<a name="l00089"></a>00089     <span class="keywordflow">return</span> <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>;
<a name="l00090"></a>00090 }
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="keyword">static</span> <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *get_actor_plugin (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00095"></a>00095     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     <span class="keywordflow">return</span> <a class="code" href="group__VisActor.html#ga626add78f7a410475262dae725e477e6">VISUAL_ACTOR_PLUGIN</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a77f88064c35a26356af60c87b636e169" title="Pointer to the plugin specific data structures.">plugin</a>);
<a name="l00098"></a>00098 }
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="group__VisActor.html#ga9ca4961c340c81b8d8e43b81eab4eee0">00100</a> <a class="code" href="struct__VisPluginData.html" title="The VisPluginData structure is the main plugin structure, every plugin is encapsulated in this...">VisPluginData</a> *<a class="code" href="group__VisActor.html#ga9ca4961c340c81b8d8e43b81eab4eee0" title="Gives the encapsulated VisPluginData from a VisActor.">visual_actor_get_plugin</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor)
<a name="l00101"></a>00101 {
<a name="l00102"></a>00102     <span class="keywordflow">return</span> actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>;
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00105"></a><a class="code" href="group__VisActor.html#ga9a42dcdec7dffed46f726b48584b654d">00105</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__VisActor.html#ga9a42dcdec7dffed46f726b48584b654d" title="Gives the next actor plugin based on the name of a plugin but skips non GL plugins.">visual_actor_get_next_by_name_gl</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00106"></a>00106 {
<a name="l00107"></a>00107     <span class="keyword">const</span> <span class="keywordtype">char</span> *next = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00108"></a>00108     <span class="keywordtype">bool</span> have_gl;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="keywordflow">do</span> {
<a name="l00111"></a>00111         next = <a class="code" href="group__VisActor.html#gad776452e889e29e08630719bacf08e88" title="Gives the next actor plugin based on the name of a plugin.">visual_actor_get_next_by_name</a> (next);
<a name="l00112"></a>00112         <span class="keywordflow">if</span> (next == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00113"></a>00113             <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <a class="code" href="struct__VisPluginRef.html" title="The VisPluginRef data structure contains information about the plugins and does refcounting.">VisPluginRef</a>*   ref       = find_actor_plugin (next);
<a name="l00116"></a>00116         <a class="code" href="struct__VisPluginData.html" title="The VisPluginData structure is the main plugin structure, every plugin is encapsulated in this...">VisPluginData</a>*  plugin    = <a class="code" href="group__VisPlugin.html#ga566f4061073d16bbad5345eba3213a16" title="Private function to load a plugin.">visual_plugin_load</a> (ref);
<a name="l00117"></a>00117         <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a>* actplugin = <a class="code" href="group__VisActor.html#ga626add78f7a410475262dae725e477e6">VISUAL_ACTOR_PLUGIN</a> (plugin-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a77f88064c35a26356af60c87b636e169" title="Pointer to the plugin specific data structures.">plugin</a>);
<a name="l00118"></a>00118 
<a name="l00119"></a>00119         have_gl = (actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a6c8fe3ed7415f62d13357522dd6db998">vidoptions</a>.<a class="code" href="struct__VisVideoAttributeOptions.html#a5bf8be08e495c09acd5ab67b11985605">depth</a> &amp; <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614caf0d4ce0057f2e910d8d1cc76feab5428" title="openGL surface flag.">VISUAL_VIDEO_DEPTH_GL</a>) &gt; 0;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <a class="code" href="group__VisPlugin.html#ga59e20eb462f5c4afa7c9361d833cb55f" title="Private function to unload a plugin.">visual_plugin_unload</a> (plugin);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123     } <span class="keywordflow">while</span> (!have_gl);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     <span class="keywordflow">return</span> next;
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="group__VisActor.html#gab97c15d68d41c99dc26584bcca990739">00128</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__VisActor.html#gab97c15d68d41c99dc26584bcca990739" title="Gives the previous actor plugin based on the name of a plugin but skips non GL plugins.">visual_actor_get_prev_by_name_gl</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130     <span class="keyword">const</span> <span class="keywordtype">char</span> *prev = name;
<a name="l00131"></a>00131     <span class="keywordtype">bool</span> have_gl;
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="keywordflow">do</span> {
<a name="l00134"></a>00134         prev = <a class="code" href="group__VisActor.html#ga78a06ae86aa014bbbfd94cd42014db9d" title="Gives the previous actor plugin based on the name of a plugin.">visual_actor_get_prev_by_name</a> (prev);
<a name="l00135"></a>00135         <span class="keywordflow">if</span> (prev == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00136"></a>00136             <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <a class="code" href="struct__VisPluginRef.html" title="The VisPluginRef data structure contains information about the plugins and does refcounting.">VisPluginRef</a>*   ref       = find_actor_plugin (prev);
<a name="l00139"></a>00139         <a class="code" href="struct__VisPluginData.html" title="The VisPluginData structure is the main plugin structure, every plugin is encapsulated in this...">VisPluginData</a>*  plugin    = <a class="code" href="group__VisPlugin.html#ga566f4061073d16bbad5345eba3213a16" title="Private function to load a plugin.">visual_plugin_load</a> (ref);
<a name="l00140"></a>00140         <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a>* actplugin = <a class="code" href="group__VisActor.html#ga626add78f7a410475262dae725e477e6">VISUAL_ACTOR_PLUGIN</a> (plugin-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a77f88064c35a26356af60c87b636e169" title="Pointer to the plugin specific data structures.">plugin</a>);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142         have_gl = (actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a6c8fe3ed7415f62d13357522dd6db998">vidoptions</a>.<a class="code" href="struct__VisVideoAttributeOptions.html#a5bf8be08e495c09acd5ab67b11985605">depth</a> &amp; <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614caf0d4ce0057f2e910d8d1cc76feab5428" title="openGL surface flag.">VISUAL_VIDEO_DEPTH_GL</a>) &gt; 0;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144         <a class="code" href="group__VisPlugin.html#ga59e20eb462f5c4afa7c9361d833cb55f" title="Private function to unload a plugin.">visual_plugin_unload</a> (plugin);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     } <span class="keywordflow">while</span> (!have_gl);
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="keywordflow">return</span> prev;
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="group__VisActor.html#gab2c428db31d4f39182ef43b1684487b7">00151</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__VisActor.html#gab2c428db31d4f39182ef43b1684487b7" title="Gives the next actor plugin based on the name of a plugin but skips GL plugins.">visual_actor_get_next_by_name_nogl</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153     <span class="keyword">const</span> <span class="keywordtype">char</span> *next = name;
<a name="l00154"></a>00154     <span class="keywordtype">bool</span> have_gl;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     <span class="keywordflow">do</span> {
<a name="l00157"></a>00157         next = <a class="code" href="group__VisActor.html#gad776452e889e29e08630719bacf08e88" title="Gives the next actor plugin based on the name of a plugin.">visual_actor_get_next_by_name</a> (next);
<a name="l00158"></a>00158         <span class="keywordflow">if</span> (next == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00159"></a>00159             <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00160"></a>00160 
<a name="l00161"></a>00161         <a class="code" href="struct__VisPluginRef.html" title="The VisPluginRef data structure contains information about the plugins and does refcounting.">VisPluginRef</a>*   ref       = find_actor_plugin (next);
<a name="l00162"></a>00162         <a class="code" href="struct__VisPluginData.html" title="The VisPluginData structure is the main plugin structure, every plugin is encapsulated in this...">VisPluginData</a>*  plugin    = <a class="code" href="group__VisPlugin.html#ga566f4061073d16bbad5345eba3213a16" title="Private function to load a plugin.">visual_plugin_load</a> (ref);
<a name="l00163"></a>00163         <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a>* actplugin = <a class="code" href="group__VisActor.html#ga626add78f7a410475262dae725e477e6">VISUAL_ACTOR_PLUGIN</a> (plugin-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a77f88064c35a26356af60c87b636e169" title="Pointer to the plugin specific data structures.">plugin</a>);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165         have_gl = (actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a6c8fe3ed7415f62d13357522dd6db998">vidoptions</a>.<a class="code" href="struct__VisVideoAttributeOptions.html#a5bf8be08e495c09acd5ab67b11985605">depth</a> &amp; <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614caf0d4ce0057f2e910d8d1cc76feab5428" title="openGL surface flag.">VISUAL_VIDEO_DEPTH_GL</a>) &gt; 0;
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <a class="code" href="group__VisPlugin.html#ga59e20eb462f5c4afa7c9361d833cb55f" title="Private function to unload a plugin.">visual_plugin_unload</a> (plugin);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169     } <span class="keywordflow">while</span> (have_gl);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     <span class="keywordflow">return</span> next;
<a name="l00172"></a>00172 }
<a name="l00173"></a>00173 
<a name="l00174"></a><a class="code" href="group__VisActor.html#gac95c91c84fc365d05aa421c517fb2357">00174</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__VisActor.html#gac95c91c84fc365d05aa421c517fb2357" title="Gives the previous actor plugin based on the name of a plugin but skips GL plugins.">visual_actor_get_prev_by_name_nogl</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00175"></a>00175 {
<a name="l00176"></a>00176     <span class="keyword">const</span> <span class="keywordtype">char</span> *prev = name;
<a name="l00177"></a>00177     <span class="keywordtype">bool</span> have_gl;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <span class="keywordflow">do</span> {
<a name="l00180"></a>00180         prev = <a class="code" href="group__VisActor.html#ga78a06ae86aa014bbbfd94cd42014db9d" title="Gives the previous actor plugin based on the name of a plugin.">visual_actor_get_prev_by_name</a> (prev);
<a name="l00181"></a>00181         <span class="keywordflow">if</span> (prev == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00182"></a>00182             <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <a class="code" href="struct__VisPluginRef.html" title="The VisPluginRef data structure contains information about the plugins and does refcounting.">VisPluginRef</a>*   ref       = find_actor_plugin (prev);
<a name="l00185"></a>00185         <a class="code" href="struct__VisPluginData.html" title="The VisPluginData structure is the main plugin structure, every plugin is encapsulated in this...">VisPluginData</a>*  plugin    = <a class="code" href="group__VisPlugin.html#ga566f4061073d16bbad5345eba3213a16" title="Private function to load a plugin.">visual_plugin_load</a> (ref);
<a name="l00186"></a>00186         <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a>* actplugin = <a class="code" href="group__VisActor.html#ga626add78f7a410475262dae725e477e6">VISUAL_ACTOR_PLUGIN</a> (plugin-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a77f88064c35a26356af60c87b636e169" title="Pointer to the plugin specific data structures.">plugin</a>);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188         have_gl = (actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a6c8fe3ed7415f62d13357522dd6db998">vidoptions</a>.<a class="code" href="struct__VisVideoAttributeOptions.html#a5bf8be08e495c09acd5ab67b11985605">depth</a> &amp; <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614caf0d4ce0057f2e910d8d1cc76feab5428" title="openGL surface flag.">VISUAL_VIDEO_DEPTH_GL</a>) &gt; 0;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         <a class="code" href="group__VisPlugin.html#ga59e20eb462f5c4afa7c9361d833cb55f" title="Private function to unload a plugin.">visual_plugin_unload</a> (plugin);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     } <span class="keywordflow">while</span> (have_gl);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <span class="keywordflow">return</span> prev;
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="group__VisActor.html#gad776452e889e29e08630719bacf08e88">00197</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__VisActor.html#gad776452e889e29e08630719bacf08e88" title="Gives the next actor plugin based on the name of a plugin.">visual_actor_get_next_by_name</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199     <span class="keywordflow">return</span> <a class="code" href="namespaceLV.html#a28e0e192b1bd7a7e6acabac945df8c61">LV::plugin_get_next_by_name</a> (get_actor_plugin_list (), name);
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="group__VisActor.html#ga78a06ae86aa014bbbfd94cd42014db9d">00202</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__VisActor.html#ga78a06ae86aa014bbbfd94cd42014db9d" title="Gives the previous actor plugin based on the name of a plugin.">visual_actor_get_prev_by_name</a> (<span class="keywordtype">char</span> <span class="keyword">const</span>* name)
<a name="l00203"></a>00203 {
<a name="l00204"></a>00204     <span class="keywordflow">return</span> <a class="code" href="namespaceLV.html#a6494d0dc4cc47b01820b27094965afba">LV::plugin_get_prev_by_name</a> (get_actor_plugin_list (), name);
<a name="l00205"></a>00205 }
<a name="l00206"></a>00206 
<a name="l00207"></a><a class="code" href="group__VisActor.html#ga01da08554c191eb4fceb5aacdbc1071b">00207</a> <a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *<a class="code" href="group__VisActor.html#ga01da08554c191eb4fceb5aacdbc1071b" title="Creates a new actor from name, the plugin will be loaded but won&#39;t be realized.">visual_actor_new</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *actorname)
<a name="l00208"></a>00208 {
<a name="l00209"></a>00209     <a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor;
<a name="l00210"></a>00210     <span class="keywordtype">int</span> result;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     actor = <a class="code" href="group__VisMem.html#gacc3a119d795b22d441e0c9189ccc3eee" title="Convenient macro to request n_structs structures of type struct_type initialized to 0...">visual_mem_new0</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a>, 1);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     result = <a class="code" href="group__VisActor.html#gab385a4ae460ede22957bea00b2e2fb3e" title="Initializes a VisActor, this will set the allocated flag for the object to FALSE.">visual_actor_init</a> (actor, actorname);
<a name="l00215"></a>00215     <span class="keywordflow">if</span> (result != <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>) {
<a name="l00216"></a>00216         <a class="code" href="group__VisMem.html#gad28e0c8516ddcb841d40b77259c78ed4" title="Frees allocated memory.">visual_mem_free</a> (actor);
<a name="l00217"></a>00217         <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="comment">/* Do the VisObject initialization */</span>
<a name="l00221"></a>00221     <a class="code" href="group__VisObject.html#gaae00a3546bb578b98c8ffbd5d189c55d" title="Sets whether a VisObject is allocated or not.">visual_object_set_allocated</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor), <a class="code" href="lv__defines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00222"></a>00222     <a class="code" href="group__VisObject.html#ga5da2f29c9d01864d6f2a42f8f0771d42" title="Increases the reference counter for a VisObject.">visual_object_ref</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor));
<a name="l00223"></a>00223 
<a name="l00224"></a>00224     <span class="keywordflow">return</span> actor;
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a><a class="code" href="group__VisActor.html#gab385a4ae460ede22957bea00b2e2fb3e">00227</a> <span class="keywordtype">int</span> <a class="code" href="group__VisActor.html#gab385a4ae460ede22957bea00b2e2fb3e" title="Initializes a VisActor, this will set the allocated flag for the object to FALSE.">visual_actor_init</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <span class="keyword">const</span> <span class="keywordtype">char</span> *actorname)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229     <a class="code" href="struct__VisPluginRef.html" title="The VisPluginRef data structure contains information about the plugins and does refcounting.">VisPluginRef</a> *ref = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00230"></a>00230     <a class="code" href="struct__VisPluginEnviron.html" title="The VisPluginEnviron is used to setup a pre realize/init environment for plugins.">VisPluginEnviron</a> *enve;
<a name="l00231"></a>00231     <a class="code" href="struct__VisActorPluginEnviron.html" title="The VisActorPluginEnviron structure is the main environmental element for a VisActorPlugin.">VisActorPluginEnviron</a> *actenviron;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba3c82ff42ea19ccd75ca4467b74fcdc8a" title="The VisActor is NULL.">VISUAL_ERROR_ACTOR_NULL</a>);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     <span class="keywordflow">if</span> (actorname &amp;&amp; get_actor_plugin_list ().empty ()) {
<a name="l00236"></a>00236         <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba8bf23a2943c56c20c179bb1d75d862c2" title="Error message, use to notify the user of fatals.">VISUAL_LOG_ERROR</a>, _(<span class="stringliteral">&quot;the plugin list is empty&quot;</span>));
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         <span class="keywordflow">return</span> -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba3b2182f05e6bcf708f188cd3f12c60eb" title="The plugin list can&#39;t be found.">VISUAL_ERROR_PLUGIN_NO_LIST</a>;
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     <span class="comment">/* Do the VisObject initialization */</span>
<a name="l00242"></a>00242     <a class="code" href="group__VisObject.html#gabd5edf81d6b96ee64d3e5a270163e0d3" title="Clears a VisObject.">visual_object_clear</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor));
<a name="l00243"></a>00243     <a class="code" href="group__VisObject.html#ga07271127d7d996c7b75fe4e652e0fa81" title="Sets the destructor function to a VisObject.">visual_object_set_dtor</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor), actor_dtor);
<a name="l00244"></a>00244     <a class="code" href="group__VisObject.html#gaae00a3546bb578b98c8ffbd5d189c55d" title="Sets whether a VisObject is allocated or not.">visual_object_set_allocated</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor), <a class="code" href="lv__defines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     <span class="comment">/* Reset the VisActor data */</span>
<a name="l00247"></a>00247     actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00248"></a>00248     actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00249"></a>00249     actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00250"></a>00250     actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00251"></a>00251     actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     actor-&gt;<a class="code" href="struct__VisActor.html#a9fcca51f6e0f8e8124dc46601230649b" title="Private member which is used to compare with new songinfo to check if a new song event should be emit...">songcompare</a> = <a class="code" href="group__VisSongInfo.html#ga3fa369206fb75185b7a241cd0cf20f1f">visual_songinfo_new</a> (<a class="code" href="group__VisSongInfo.html#gga55f0e16e11d41edba9a793651af2d836af16388046dc77195410096d701ca2dea" title="No song info is given.">VISUAL_SONGINFO_TYPE_NULL</a>);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <span class="keywordflow">if</span> (actorname == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00256"></a>00256         <span class="keywordflow">return</span> <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>;
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     ref = find_actor_plugin (actorname);
<a name="l00259"></a>00259     <span class="keywordflow">if</span> (ref == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00260"></a>00260         <span class="keywordflow">return</span> -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba5d56a4041ca58114a7199c00d4aab7ce" title="The plugin can&#39;t be found.">VISUAL_ERROR_PLUGIN_NOT_FOUND</a>;
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262 
<a name="l00263"></a>00263     actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> = <a class="code" href="group__VisPlugin.html#ga566f4061073d16bbad5345eba3213a16" title="Private function to load a plugin.">visual_plugin_load</a> (ref);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <span class="comment">// FIXME: Hack to initialize songinfo</span>
<a name="l00266"></a>00266     {
<a name="l00267"></a>00267         <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin = (<a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *) actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a77f88064c35a26356af60c87b636e169" title="Pointer to the plugin specific data structures.">plugin</a>;
<a name="l00268"></a>00268         actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a> = <a class="code" href="group__VisSongInfo.html#ga3fa369206fb75185b7a241cd0cf20f1f">visual_songinfo_new</a> (<a class="code" href="group__VisSongInfo.html#gga55f0e16e11d41edba9a793651af2d836af16388046dc77195410096d701ca2dea" title="No song info is given.">VISUAL_SONGINFO_TYPE_NULL</a>);
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="comment">/* Adding the VisActorPluginEnviron */</span>
<a name="l00272"></a>00272     actenviron = <a class="code" href="group__VisMem.html#gacc3a119d795b22d441e0c9189ccc3eee" title="Convenient macro to request n_structs structures of type struct_type initialized to 0...">visual_mem_new0</a> (<a class="code" href="struct__VisActorPluginEnviron.html" title="The VisActorPluginEnviron structure is the main environmental element for a VisActorPlugin.">VisActorPluginEnviron</a>, 1);
<a name="l00273"></a>00273 
<a name="l00274"></a>00274     <a class="code" href="group__VisObject.html#gafa30ee9f9c0047a0b8e50cae19394571" title="Initializes a VisObject for usage.">visual_object_initialize</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actenviron), <a class="code" href="lv__defines_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00275"></a>00275 
<a name="l00276"></a>00276     enve = <a class="code" href="group__VisPlugin.html#ga1dbac7b0ba3bef82cfdcd932f317fc2e" title="Creates a VisPluginEnviron structure.">visual_plugin_environ_new</a> (<a class="code" href="group__VisActor.html#ga32ad3524ec4accae593f08c2277677b9" title="Name defination of the standard VisActorPluginEnviron element for an actor plugin.">VISUAL_ACTOR_PLUGIN_ENVIRON</a>, <a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actenviron));
<a name="l00277"></a>00277     <a class="code" href="group__VisPlugin.html#ga0eee97877e3e14cad70b054edd353fff" title="Adds a VisPluginEnviron to the plugin its environment list.">visual_plugin_environ_add</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>, enve);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     <span class="keywordflow">return</span> <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>;
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="group__VisActor.html#gaed2ac1c542f9d4c00f0ee35c2a29df4d">00282</a> <span class="keywordtype">int</span> <a class="code" href="group__VisActor.html#gaed2ac1c542f9d4c00f0ee35c2a29df4d" title="Realize the VisActor.">visual_actor_realize</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor)
<a name="l00283"></a>00283 {
<a name="l00284"></a>00284     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba3c82ff42ea19ccd75ca4467b74fcdc8a" title="The VisActor is NULL.">VISUAL_ERROR_ACTOR_NULL</a>);
<a name="l00285"></a>00285     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55bacf4870c46592ec5a16b3f581982c64a4" title="The VisPluginData is NULL.">VISUAL_ERROR_PLUGIN_NULL</a>);
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <span class="keywordflow">return</span> <a class="code" href="group__VisPlugin.html#ga6e6d0f42f2e1d219a9285ea32b378543" title="Private function to realize the plugin.">visual_plugin_realize</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>);
<a name="l00288"></a>00288 }
<a name="l00289"></a>00289 
<a name="l00290"></a><a class="code" href="group__VisActor.html#ga7752e9f01bbc0a8d46beb8d7c0b96fd4">00290</a> <a class="code" href="group__VisSongInfo.html#gacc5e33dc7cedc298a63df2e90ca69904">VisSongInfo</a> *<a class="code" href="group__VisActor.html#ga7752e9f01bbc0a8d46beb8d7c0b96fd4" title="Gives a pointer to the song info data within the VisActor.">visual_actor_get_songinfo</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor)
<a name="l00291"></a>00291 {
<a name="l00292"></a>00292     <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     actplugin = get_actor_plugin (actor);
<a name="l00297"></a>00297     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actplugin != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299     <span class="keywordflow">return</span> actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a>;
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="group__VisActor.html#ga669158ea1f57be9e0f7b33b467aded37">00302</a> <a class="code" href="group__VisPalette.html#gac2585e3f0a455ed8b09ef3a331cd558b">VisPalette</a> *<a class="code" href="group__VisActor.html#ga669158ea1f57be9e0f7b33b467aded37" title="Gives a pointer to the palette within the VisActor.">visual_actor_get_palette</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304     <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00307"></a>00307 
<a name="l00308"></a>00308     actplugin = get_actor_plugin (actor);
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="keywordflow">if</span> (actplugin == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00311"></a>00311         <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba8bf23a2943c56c20c179bb1d75d862c2" title="Error message, use to notify the user of fatals.">VISUAL_LOG_ERROR</a>,
<a name="l00312"></a>00312             _(<span class="stringliteral">&quot;The given actor does not reference any actor plugin&quot;</span>));
<a name="l00313"></a>00313         <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00314"></a>00314     }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp;
<a name="l00317"></a>00317         actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a> == <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614ca8e0303737d37fd8a400837ea3db72089" title="8 bits indexed surface flag.">VISUAL_VIDEO_DEPTH_8BIT</a>) {
<a name="l00318"></a>00318 
<a name="l00319"></a>00319         <span class="keywordflow">return</span> actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a>;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321     } <span class="keywordflow">else</span> {
<a name="l00322"></a>00322         <span class="keywordflow">return</span> actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#ab50e67e2fc3c1074d91699c5b372f639" title="Used to retrieve the desired palette from the plugin.">palette</a> (<a class="code" href="group__VisActor.html#ga9ca4961c340c81b8d8e43b81eab4eee0" title="Gives the encapsulated VisPluginData from a VisActor.">visual_actor_get_plugin</a> (actor));
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="group__VisActor.html#gac555da4ea9cd59abe583792b1cabb4c2">00328</a> <span class="keywordtype">int</span> <a class="code" href="group__VisActor.html#gac555da4ea9cd59abe583792b1cabb4c2" title="This function negotiates the VisActor with it&#39;s target video that is set by visual_actor_set_video.">visual_actor_video_negotiate</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <span class="keywordtype">int</span> rundepth, <span class="keywordtype">int</span> noevent, <span class="keywordtype">int</span> forced)
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330     <span class="keywordtype">int</span> depthflag;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba3c82ff42ea19ccd75ca4467b74fcdc8a" title="The VisActor is NULL.">VISUAL_ERROR_ACTOR_NULL</a>);
<a name="l00333"></a>00333     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55bacf4870c46592ec5a16b3f581982c64a4" title="The VisPluginData is NULL.">VISUAL_ERROR_PLUGIN_NULL</a>);
<a name="l00334"></a>00334     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>-&gt;<a class="code" href="struct__VisPluginData.html#a68674d95856442f1cb5813ba5ed75e5c" title="Pointer to the plugin references corresponding to this VisPluginData.">ref</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55bacf274b2f3af71ceff098e1fc0024101e" title="The VisPluginRef is NULL.">VISUAL_ERROR_PLUGIN_REF_NULL</a>);
<a name="l00335"></a>00335     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55bad17b22da337e4e75e6c345ca290064a6" title="The VisVideo target member in the VisActor is NULL.">VISUAL_ERROR_ACTOR_VIDEO_NULL</a>);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00338"></a>00338         <a class="code" href="group__VisObject.html#gafd90dd70679ecae99a4a55cd605556b6" title="Decreases the reference counter for a VisObject.">visual_object_unref</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>));
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00341"></a>00341     }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00344"></a>00344         <a class="code" href="group__VisObject.html#gafd90dd70679ecae99a4a55cd605556b6" title="Decreases the reference counter for a VisObject.">visual_object_unref</a> (<a class="code" href="group__VisObject.html#gaf188438cc2a544151f50b4fb4db53e86">VISUAL_OBJECT</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a>));
<a name="l00345"></a>00345 
<a name="l00346"></a>00346         actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00350"></a>00350         <a class="code" href="group__VisPalette.html#ga3f12fa05345a0999bc4cb7773edad605">visual_palette_free</a> (actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a>);
<a name="l00351"></a>00351         actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a> = <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353 
<a name="l00354"></a>00354     depthflag = <a class="code" href="group__VisActor.html#ga19cfc3b365e3d614ffd9b516b7c8ac2e" title="Gives the by the plugin natively supported depths.">visual_actor_get_supported_depth</a> (actor);
<a name="l00355"></a>00355 
<a name="l00356"></a>00356     <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba47094c451b761dc456d8188d1868f5a7" title="Informative message, can be used for general info.">VISUAL_LOG_INFO</a>, <span class="stringliteral">&quot;negotiating plugin %s&quot;</span>, actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>-&gt;<a class="code" href="struct__VisPluginData.html#a0a3f1d95fec9f79c05871e83700e4d72" title="Pointer to the VisPluginInfo that is obtained from the plugin.">info</a>-&gt;<a class="code" href="struct__VisPluginInfo.html#a68a60df7f834c5e72dd7f60d35dfabc0" title="Long name.">name</a>);
<a name="l00357"></a>00357 
<a name="l00358"></a>00358     <span class="comment">/* Set up depth transformation enviroment */</span>
<a name="l00359"></a>00359     <span class="keywordflow">if</span> (!<a class="code" href="group__VisVideo.html#ga4302a1d0c248420483ae24851970e044" title="Checks if a certain depth is supported by checking against an ORred depthflag.">visual_video_depth_is_supported</a> (depthflag, actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a>) ||
<a name="l00360"></a>00360             (forced &amp;&amp; actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a> != rundepth))
<a name="l00361"></a>00361         <span class="comment">/* When the depth is not supported, or if we only switch the depth and not</span>
<a name="l00362"></a>00362 <span class="comment">         * the size */</span>
<a name="l00363"></a>00363         <span class="keywordflow">return</span> negotiate_video_with_unsupported_depth (actor, rundepth, noevent, forced);
<a name="l00364"></a>00364     <span class="keywordflow">else</span>
<a name="l00365"></a>00365         <span class="keywordflow">return</span> negotiate_video (actor, noevent);
<a name="l00366"></a>00366 
<a name="l00367"></a>00367     <span class="keywordflow">return</span> -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba8f4228439a6155fecc257ce44504a5e3" title="The impossible happened, this should never happen.">VISUAL_ERROR_IMPOSSIBLE</a>;
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 <span class="keyword">static</span> <span class="keywordtype">int</span> negotiate_video_with_unsupported_depth (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <span class="keywordtype">int</span> rundepth, <span class="keywordtype">int</span> noevent, <span class="keywordtype">int</span> forced)
<a name="l00371"></a>00371 {
<a name="l00372"></a>00372     <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin = get_actor_plugin (actor);
<a name="l00373"></a>00373     <span class="keywordtype">int</span> depthflag = <a class="code" href="group__VisActor.html#ga19cfc3b365e3d614ffd9b516b7c8ac2e" title="Gives the by the plugin natively supported depths.">visual_actor_get_supported_depth</a> (actor);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375     <span class="comment">/* Depth transform enviroment, it automaticly</span>
<a name="l00376"></a>00376 <span class="comment">     * fits size because it can use the pitch from</span>
<a name="l00377"></a>00377 <span class="comment">     * the dest video context */</span>
<a name="l00378"></a>00378     actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a> = <a class="code" href="group__VisVideo.html#gaff20b9be5b08834831fbaf8e64e4d74a" title="Creates a new VisVideo structure, without an associated screen buffer.">visual_video_new</a> ();
<a name="l00379"></a>00379 
<a name="l00380"></a>00380     <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba47094c451b761dc456d8188d1868f5a7" title="Informative message, can be used for general info.">VISUAL_LOG_INFO</a>, _(<span class="stringliteral">&quot;run depth %d forced %d&quot;</span>), rundepth, forced);
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="keywordflow">if</span> (forced)
<a name="l00383"></a>00383         <a class="code" href="group__VisVideo.html#ga843336f680cd6714571f9b9e06d40449" title="Sets the depth for a VisVideo.">visual_video_set_depth</a> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>, <a class="code" href="group__VisVideo.html#ga2832fcb27e3ba79fae7e8de0f408614c" title="Enumerate that defines video depths for use within plugins, libvisual functions, etc.">VisVideoDepth</a> (rundepth));
<a name="l00384"></a>00384     <span class="keywordflow">else</span>
<a name="l00385"></a>00385         <a class="code" href="group__VisVideo.html#ga843336f680cd6714571f9b9e06d40449" title="Sets the depth for a VisVideo.">visual_video_set_depth</a> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>,
<a name="l00386"></a>00386                 <a class="code" href="group__VisVideo.html#ga41b289796f2ff23af4c9bd7803000856" title="Return the highest supported depth that is NOT openGL.">visual_video_depth_get_highest_nogl</a> (depthflag));
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba47094c451b761dc456d8188d1868f5a7" title="Informative message, can be used for general info.">VISUAL_LOG_INFO</a>, _(<span class="stringliteral">&quot;transpitch1 %d depth %d bpp %d&quot;</span>), actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a1a0e49c2e6ace821672d7166031f29a2" title="Surface it&#39;s pitch value.">pitch</a>, actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a>,
<a name="l00389"></a>00389             actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a0ed6e55ab48e33c65987ecff0d7db5ba" title="Surface it&#39;s bytes per pixel.">bpp</a>);
<a name="l00390"></a>00390     <span class="comment">/* If there is only GL (which gets returned by highest nogl if</span>
<a name="l00391"></a>00391 <span class="comment">     * nothing else is there, stop here */</span>
<a name="l00392"></a>00392     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a> == <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614caf0d4ce0057f2e910d8d1cc76feab5428" title="openGL surface flag.">VISUAL_VIDEO_DEPTH_GL</a>)
<a name="l00393"></a>00393         <span class="keywordflow">return</span> -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba81fb9b16e0b445f039191576f820a6e1" title="Tried depth forcing a GL VisACtor.">VISUAL_ERROR_ACTOR_GL_NEGOTIATE</a>;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395     <a class="code" href="group__VisVideo.html#gab483fa7ca87cea384cf890286f35d8c5" title="Sets the dimension for a VisVideo.">visual_video_set_dimension</a> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>, actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>, actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>);
<a name="l00396"></a>00396     <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba47094c451b761dc456d8188d1868f5a7" title="Informative message, can be used for general info.">VISUAL_LOG_INFO</a>, _(<span class="stringliteral">&quot;transpitch2 %d %d&quot;</span>), actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>, actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a1a0e49c2e6ace821672d7166031f29a2" title="Surface it&#39;s pitch value.">pitch</a>);
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a0030d5af9e1fca1c9409dcb55ec63149" title="The requisition function.">requisition</a> (<a class="code" href="group__VisActor.html#ga9ca4961c340c81b8d8e43b81eab4eee0" title="Gives the encapsulated VisPluginData from a VisActor.">visual_actor_get_plugin</a> (actor), &amp;actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>, &amp;actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>);
<a name="l00399"></a>00399     <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba47094c451b761dc456d8188d1868f5a7" title="Informative message, can be used for general info.">VISUAL_LOG_INFO</a>, _(<span class="stringliteral">&quot;transpitch3 %d&quot;</span>), actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a1a0e49c2e6ace821672d7166031f29a2" title="Surface it&#39;s pitch value.">pitch</a>);
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <span class="keywordflow">if</span> (!noevent) {
<a name="l00402"></a>00402         <a class="code" href="group__VisEvent.html#ga116c86478c1c3d632e7654c17313944a" title="Adds a new dimension change event to the event queue.">visual_event_queue_add_resize</a> (&amp;actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>-&gt;<a class="code" href="struct__VisPluginData.html#a9f5cb106db052862fea5c4d77573a103" title="The plugin it&#39;s VisEventQueue for queueing events.">eventqueue</a>, actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>,
<a name="l00403"></a>00403                 actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>, actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>);
<a name="l00404"></a>00404         <a class="code" href="group__VisPlugin.html#ga69753163ff297eee666e1995fae4201e" title="Pumps the queued events into the plugin it&#39;s event handler if it has one.">visual_plugin_events_pump</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>);
<a name="l00405"></a>00405     } <span class="keywordflow">else</span> {
<a name="l00406"></a>00406         <span class="comment">/* Normally a visual_video_set_dimension get&#39;s called within the</span>
<a name="l00407"></a>00407 <span class="comment">         * event handler, but we won&#39;t come there right now so we&#39;ve</span>
<a name="l00408"></a>00408 <span class="comment">         * got to set the pitch ourself */</span>
<a name="l00409"></a>00409         <a class="code" href="group__VisVideo.html#gab483fa7ca87cea384cf890286f35d8c5" title="Sets the dimension for a VisVideo.">visual_video_set_dimension</a> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>,
<a name="l00410"></a>00410                 actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>, actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>);
<a name="l00411"></a>00411     }
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba47094c451b761dc456d8188d1868f5a7" title="Informative message, can be used for general info.">VISUAL_LOG_INFO</a>, _(<span class="stringliteral">&quot;rundepth: %d transpitch %d&quot;</span>), rundepth, actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>-&gt;<a class="code" href="struct__VisVideo.html#a1a0e49c2e6ace821672d7166031f29a2" title="Surface it&#39;s pitch value.">pitch</a>);
<a name="l00414"></a>00414     <a class="code" href="group__VisVideo.html#gaefb8348e556887774f1119473379954b" title="Allocates a buffer for the VisVideo.">visual_video_allocate_buffer</a> (actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416     <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a> == <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614ca8e0303737d37fd8a400837ea3db72089" title="8 bits indexed surface flag.">VISUAL_VIDEO_DEPTH_8BIT</a>)
<a name="l00417"></a>00417         actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a> = <a class="code" href="group__VisPalette.html#gad8eb3bb8e0f356e92ded433bbd87ab99">visual_palette_new</a> (256);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <span class="keywordflow">return</span> <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>;
<a name="l00420"></a>00420 }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 <span class="keyword">static</span> <span class="keywordtype">int</span> negotiate_video (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <span class="keywordtype">int</span> noevent)
<a name="l00423"></a>00423 {
<a name="l00424"></a>00424     <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin = get_actor_plugin (actor);
<a name="l00425"></a>00425     <span class="keywordtype">int</span> tmpwidth, tmpheight, tmppitch;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     tmpwidth = actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>;
<a name="l00428"></a>00428     tmpheight = actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>;
<a name="l00429"></a>00429     tmppitch = actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#a1a0e49c2e6ace821672d7166031f29a2" title="Surface it&#39;s pitch value.">pitch</a>;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <span class="comment">/* Pump the resize events and handle all the pending events */</span>
<a name="l00432"></a>00432     actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a0030d5af9e1fca1c9409dcb55ec63149" title="The requisition function.">requisition</a> (<a class="code" href="group__VisActor.html#ga9ca4961c340c81b8d8e43b81eab4eee0" title="Gives the encapsulated VisPluginData from a VisActor.">visual_actor_get_plugin</a> (actor), &amp;actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>, &amp;actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     <span class="keywordflow">if</span> (!noevent) {
<a name="l00435"></a>00435         <a class="code" href="group__VisEvent.html#ga116c86478c1c3d632e7654c17313944a" title="Adds a new dimension change event to the event queue.">visual_event_queue_add_resize</a> (&amp;actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>-&gt;<a class="code" href="struct__VisPluginData.html#a9f5cb106db052862fea5c4d77573a103" title="The plugin it&#39;s VisEventQueue for queueing events.">eventqueue</a>, actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>,
<a name="l00436"></a>00436                 actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>, actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>);
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         <a class="code" href="group__VisPlugin.html#ga69753163ff297eee666e1995fae4201e" title="Pumps the queued events into the plugin it&#39;s event handler if it has one.">visual_plugin_events_pump</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>);
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <span class="comment">/* Size fitting enviroment */</span>
<a name="l00442"></a>00442     <span class="keywordflow">if</span> (tmpwidth != actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a> || tmpheight != actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>) {
<a name="l00443"></a>00443         <span class="keywordflow">if</span> (actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a> != <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614caf0d4ce0057f2e910d8d1cc76feab5428" title="openGL surface flag.">VISUAL_VIDEO_DEPTH_GL</a>) {
<a name="l00444"></a>00444             actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a> = <a class="code" href="group__VisVideo.html#ga334b47917488c4d5bf50c01f7ec0078a" title="Creates a new VisVideo and also allocates a buffer.">visual_video_new_with_buffer</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a>,
<a name="l00445"></a>00445                     actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>, actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a>);
<a name="l00446"></a>00446         }
<a name="l00447"></a>00447 
<a name="l00448"></a>00448         <a class="code" href="group__VisVideo.html#gab483fa7ca87cea384cf890286f35d8c5" title="Sets the dimension for a VisVideo.">visual_video_set_dimension</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>, tmpwidth, tmpheight);
<a name="l00449"></a>00449     }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <span class="comment">/* Set the pitch seen this is the framebuffer context */</span>
<a name="l00452"></a>00452     <a class="code" href="group__VisVideo.html#gaa1a8afd785a9e3591826011aa11e30ba" title="Sets the pitch for a VisVideo.">visual_video_set_pitch</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>, tmppitch);
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <span class="keywordflow">return</span> <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>;
<a name="l00455"></a>00455 }
<a name="l00456"></a>00456 
<a name="l00466"></a><a class="code" href="group__VisActor.html#ga19cfc3b365e3d614ffd9b516b7c8ac2e">00466</a> <span class="keywordtype">int</span> <a class="code" href="group__VisActor.html#ga19cfc3b365e3d614ffd9b516b7c8ac2e" title="Gives the by the plugin natively supported depths.">visual_actor_get_supported_depth</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor)
<a name="l00467"></a>00467 {
<a name="l00468"></a>00468     <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba3c82ff42ea19ccd75ca4467b74fcdc8a" title="The VisActor is NULL.">VISUAL_ERROR_ACTOR_NULL</a>);
<a name="l00471"></a>00471     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55bacf4870c46592ec5a16b3f581982c64a4" title="The VisPluginData is NULL.">VISUAL_ERROR_PLUGIN_NULL</a>);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     actplugin = get_actor_plugin (actor);
<a name="l00474"></a>00474 
<a name="l00475"></a>00475     <span class="keywordflow">if</span> (actplugin == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00476"></a>00476         <span class="keywordflow">return</span> -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba1599d4caa46ec186b0f0be971dcefd2a" title="The VisActor plugin in this context is NULL.">VISUAL_ERROR_ACTOR_PLUGIN_NULL</a>;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478     <span class="keywordflow">return</span> actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a6c8fe3ed7415f62d13357522dd6db998">vidoptions</a>.<a class="code" href="struct__VisVideoAttributeOptions.html#a5bf8be08e495c09acd5ab67b11985605">depth</a>;
<a name="l00479"></a>00479 }
<a name="l00480"></a>00480 
<a name="l00481"></a><a class="code" href="group__VisActor.html#ga2f3bafbcb3dffeebf3cdc736aa65dcc6">00481</a> <a class="code" href="struct__VisVideoAttributeOptions.html">VisVideoAttributeOptions</a> *<a class="code" href="group__VisActor.html#ga2f3bafbcb3dffeebf3cdc736aa65dcc6">visual_actor_get_video_attribute_options</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor)
<a name="l00482"></a>00482 {
<a name="l00483"></a>00483     <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00486"></a>00486     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00487"></a>00487 
<a name="l00488"></a>00488     actplugin = get_actor_plugin (actor);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490     <span class="keywordflow">if</span> (actplugin == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00491"></a>00491         <span class="keywordflow">return</span> <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493     <span class="keywordflow">return</span> &amp;actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#a6c8fe3ed7415f62d13357522dd6db998">vidoptions</a>;
<a name="l00494"></a>00494 }
<a name="l00495"></a>00495 
<a name="l00496"></a><a class="code" href="group__VisActor.html#ga9aed00a297b75f03095d0912873feb78">00496</a> <span class="keywordtype">int</span> <a class="code" href="group__VisActor.html#ga9aed00a297b75f03095d0912873feb78" title="Used to connect the target display it&#39;s VisVideo structure to the VisActor.">visual_actor_set_video</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <a class="code" href="struct__VisVideo.html" title="Data structure that contains all the information about a screen surface.">VisVideo</a> *video)
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba3c82ff42ea19ccd75ca4467b74fcdc8a" title="The VisActor is NULL.">VISUAL_ERROR_ACTOR_NULL</a>);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a> = video;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     <span class="keywordflow">return</span> <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>;
<a name="l00503"></a>00503 }
<a name="l00504"></a>00504 
<a name="l00505"></a><a class="code" href="group__VisActor.html#ga433d1ed11df07c4b5f9df42874255253">00505</a> <span class="keywordtype">int</span> <a class="code" href="group__VisActor.html#ga433d1ed11df07c4b5f9df42874255253" title="This is called to run a VisActor.">visual_actor_run</a> (<a class="code" href="struct__VisActor.html" title="The VisActor structure encapsulates the actor plugin and provides abstract interfaces to the actor...">VisActor</a> *actor, <a class="code" href="struct__VisAudio.html" title="The VisAudio structure contains the sample and extra information about the sample like a 256 bands an...">VisAudio</a> *audio)
<a name="l00506"></a>00506 {
<a name="l00507"></a>00507     <a class="code" href="struct__VisActorPlugin.html" title="The VisActorPlugin structure is the main data structure for the actor (visualisation) plugin...">VisActorPlugin</a> *actplugin;
<a name="l00508"></a>00508     <a class="code" href="struct__VisPluginData.html" title="The VisPluginData structure is the main plugin structure, every plugin is encapsulated in this...">VisPluginData</a> *plugin;
<a name="l00509"></a>00509     <a class="code" href="struct__VisVideo.html" title="Data structure that contains all the information about a screen surface.">VisVideo</a> *video;
<a name="l00510"></a>00510     <a class="code" href="struct__VisVideo.html" title="Data structure that contains all the information about a screen surface.">VisVideo</a> *transform;
<a name="l00511"></a>00511     <a class="code" href="struct__VisVideo.html" title="Data structure that contains all the information about a screen surface.">VisVideo</a> *fitting;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513     <span class="comment">/* We don&#39;t check for video, because we don&#39;t always need a video */</span>
<a name="l00514"></a>00514     <span class="comment">/*</span>
<a name="l00515"></a>00515 <span class="comment">     * Really? take a look at visual_video_set_palette bellow</span>
<a name="l00516"></a>00516 <span class="comment">     */</span>
<a name="l00517"></a>00517     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba3c82ff42ea19ccd75ca4467b74fcdc8a" title="The VisActor is NULL.">VISUAL_ERROR_ACTOR_NULL</a>);
<a name="l00518"></a>00518     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a> != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55bad17b22da337e4e75e6c345ca290064a6" title="The VisVideo target member in the VisActor is NULL.">VISUAL_ERROR_ACTOR_VIDEO_NULL</a>);
<a name="l00519"></a>00519     <a class="code" href="lv__checks_8h.html#a34012d2243c29a51364c5c335781d572" title="Return if val if expr is FALSE, showing a critical message with useful information.">visual_return_val_if_fail</a> (audio != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba606cf7fa9aaca062a61fce0dcd7c8ef3" title="Something is NULL that shouldn&#39;t be.">VISUAL_ERROR_NULL</a>);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     actplugin = get_actor_plugin (actor);
<a name="l00522"></a>00522     plugin = <a class="code" href="group__VisActor.html#ga9ca4961c340c81b8d8e43b81eab4eee0" title="Gives the encapsulated VisPluginData from a VisActor.">visual_actor_get_plugin</a> (actor);
<a name="l00523"></a>00523 
<a name="l00524"></a>00524     <span class="keywordflow">if</span> (actplugin == <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00525"></a>00525         <a class="code" href="group__VisLog.html#ga6cb2aa41edb99cc803a3893601f2362c" title="Used for log messages, this is brought under a define so that the __FILE__ and __LINE__ macros (and p...">visual_log</a> (<a class="code" href="group__VisLog.html#gga9fed3305ac1acb555bc97dc26f350e3ba8bf23a2943c56c20c179bb1d75d862c2" title="Error message, use to notify the user of fatals.">VISUAL_LOG_ERROR</a>,
<a name="l00526"></a>00526             _(<span class="stringliteral">&quot;The given actor does not reference any actor plugin&quot;</span>));
<a name="l00527"></a>00527 
<a name="l00528"></a>00528         <span class="keywordflow">return</span> -<a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba1599d4caa46ec186b0f0be971dcefd2a" title="The VisActor plugin in this context is NULL.">VISUAL_ERROR_ACTOR_PLUGIN_NULL</a>;
<a name="l00529"></a>00529     }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     <span class="comment">/* Songinfo handling */</span>
<a name="l00532"></a>00532     <span class="keywordflow">if</span> (!<a class="code" href="group__VisSongInfo.html#ga495736364a5a3165912b5f288258017d">visual_songinfo_compare</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9fcca51f6e0f8e8124dc46601230649b" title="Private member which is used to compare with new songinfo to check if a new song event should be emit...">songcompare</a>, actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a>) ||
<a name="l00533"></a>00533         <a class="code" href="group__VisSongInfo.html#ga75cdbb85e6f29e6e7c04680f14cfe1d4">visual_songinfo_get_elapsed</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9fcca51f6e0f8e8124dc46601230649b" title="Private member which is used to compare with new songinfo to check if a new song event should be emit...">songcompare</a>) != <a class="code" href="group__VisSongInfo.html#ga75cdbb85e6f29e6e7c04680f14cfe1d4">visual_songinfo_get_elapsed</a> (actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a>)) {
<a name="l00534"></a>00534 
<a name="l00535"></a>00535         <a class="code" href="group__VisSongInfo.html#ga9d204e673811a93ced842e2b1dccf33a">visual_songinfo_mark</a> (actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a>);
<a name="l00536"></a>00536 
<a name="l00537"></a>00537         <a class="code" href="group__VisEvent.html#ga069a2bce0de7fe4f861ddf315c853745" title="Adds a new song change event to the event queue.">visual_event_queue_add_newsong</a> (
<a name="l00538"></a>00538             <a class="code" href="group__VisPlugin.html#gadb98d5cd59c6baf3182251ea7827bb39" title="Gives the event queue from a VisPluginData.">visual_plugin_get_eventqueue</a> (plugin),
<a name="l00539"></a>00539             actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a>);
<a name="l00540"></a>00540 
<a name="l00541"></a>00541         <a class="code" href="group__VisSongInfo.html#ga96e17465c40b9c9b908bd87a7bb1d73a">visual_songinfo_copy</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9fcca51f6e0f8e8124dc46601230649b" title="Private member which is used to compare with new songinfo to check if a new song event should be emit...">songcompare</a>, actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#aa74d905b1d9874d12a63b27d3faf22c4" title="Pointer to VisSongInfo that contains information about the current playing song.">songinfo</a>);
<a name="l00542"></a>00542     }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     video = actor-&gt;<a class="code" href="struct__VisActor.html#a2df561380da396c37073da6c4a194400" title="Pointer to the target display video.">video</a>;
<a name="l00545"></a>00545     transform = actor-&gt;<a class="code" href="struct__VisActor.html#ae883eccb5fee9932785bc04b25baa588" title="Private member which is used for depth transformation.">transform</a>;
<a name="l00546"></a>00546     fitting = actor-&gt;<a class="code" href="struct__VisActor.html#a684f0a1d80056e8f48a094c1393a2f5b" title="Private member which is used to fit the plugin.">fitting</a>;
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="comment">/*</span>
<a name="l00549"></a>00549 <span class="comment">     * This needs to happen before palette, render stuff, always, period.</span>
<a name="l00550"></a>00550 <span class="comment">     * Also internal vars can be initialized when params have been set in init on the param</span>
<a name="l00551"></a>00551 <span class="comment">     * events in the event loop.</span>
<a name="l00552"></a>00552 <span class="comment">     */</span>
<a name="l00553"></a>00553     <a class="code" href="group__VisPlugin.html#ga69753163ff297eee666e1995fae4201e" title="Pumps the queued events into the plugin it&#39;s event handler if it has one.">visual_plugin_events_pump</a> (actor-&gt;<a class="code" href="struct__VisActor.html#a9c56279cd4ea58d0181a58aabbc7de69" title="Pointer to the plugin itself.">plugin</a>);
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     <span class="comment">/* Set the palette to the target video */</span>
<a name="l00556"></a>00556     <a class="code" href="group__VisVideo.html#ga9e937d0d82e61c43fd0144ad080151cb" title="Sets a palette to a VisVideo.">visual_video_set_palette</a> (video, <a class="code" href="group__VisActor.html#ga669158ea1f57be9e0f7b33b467aded37" title="Gives a pointer to the palette within the VisActor.">visual_actor_get_palette</a> (actor));
<a name="l00557"></a>00557 
<a name="l00558"></a>00558     <span class="comment">/* Yeah some transformation magic is going on here when needed */</span>
<a name="l00559"></a>00559     <span class="keywordflow">if</span> (transform != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; (transform-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a> != video-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a>)) {
<a name="l00560"></a>00560         actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#ae8ee68097c60cff03b7d951ee91b1761" title="The main render loop.">render</a> (plugin, transform, audio);
<a name="l00561"></a>00561 
<a name="l00562"></a>00562         <span class="keywordflow">if</span> (transform-&gt;<a class="code" href="struct__VisVideo.html#aec4117510d36427bd2ccc6e024941201" title="Surface it&#39;s depth.">depth</a> == <a class="code" href="group__VisVideo.html#gga2832fcb27e3ba79fae7e8de0f408614ca8e0303737d37fd8a400837ea3db72089" title="8 bits indexed surface flag.">VISUAL_VIDEO_DEPTH_8BIT</a>) {
<a name="l00563"></a>00563             <a class="code" href="group__VisVideo.html#ga9e937d0d82e61c43fd0144ad080151cb" title="Sets a palette to a VisVideo.">visual_video_set_palette</a> (transform, <a class="code" href="group__VisActor.html#ga669158ea1f57be9e0f7b33b467aded37" title="Gives a pointer to the palette within the VisActor.">visual_actor_get_palette</a> (actor));
<a name="l00564"></a>00564             <a class="code" href="group__VisVideo.html#ga9580addd8cd5a8abddec4842b953d719" title="Video depth transforms one VisVideo into another using the depth information stored within the VisVid...">visual_video_depth_transform</a> (video, transform);
<a name="l00565"></a>00565         } <span class="keywordflow">else</span> {
<a name="l00566"></a>00566             <a class="code" href="group__VisVideo.html#ga9e937d0d82e61c43fd0144ad080151cb" title="Sets a palette to a VisVideo.">visual_video_set_palette</a> (transform, actor-&gt;<a class="code" href="struct__VisActor.html#aac26e1ff1ef439f49b940296bb9f84bf" title="Private member in which a palette is set when transforming depth from true color to indexed...">ditherpal</a>);
<a name="l00567"></a>00567             <a class="code" href="group__VisVideo.html#ga9580addd8cd5a8abddec4842b953d719" title="Video depth transforms one VisVideo into another using the depth information stored within the VisVid...">visual_video_depth_transform</a> (video, transform);
<a name="l00568"></a>00568         }
<a name="l00569"></a>00569     } <span class="keywordflow">else</span> {
<a name="l00570"></a>00570         <span class="keywordflow">if</span> (fitting != <a class="code" href="lv__defines_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; (fitting-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a> != video-&gt;<a class="code" href="struct__VisVideo.html#abdc261c2614f2e5bb7417dd38710c25e" title="Surface it&#39;s width.">width</a> || fitting-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a> != video-&gt;<a class="code" href="struct__VisVideo.html#a8ada881d41dc65ead702708d5a3bd137" title="Surface it&#39;s height.">height</a>)) {
<a name="l00571"></a>00571             actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#ae8ee68097c60cff03b7d951ee91b1761" title="The main render loop.">render</a> (plugin, fitting, audio);
<a name="l00572"></a>00572             <a class="code" href="group__VisVideo.html#ga97113f079df09d012be622b5fbe035a2" title="This function blits a VisVideo into another VisVideo.">visual_video_blit_overlay</a> (video, fitting, 0, 0, <a class="code" href="lv__defines_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00573"></a>00573         } <span class="keywordflow">else</span> {
<a name="l00574"></a>00574             actplugin-&gt;<a class="code" href="struct__VisActorPlugin.html#ae8ee68097c60cff03b7d951ee91b1761" title="The main render loop.">render</a> (plugin, video, audio);
<a name="l00575"></a>00575         }
<a name="l00576"></a>00576     }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578     <span class="keywordflow">return</span> <a class="code" href="group__VisError.html#gga06fc87d81c62e9abb8790b6e5713c55ba73e463399cd84c08294d95cf0b4b7cf8" title="No error.">VISUAL_OK</a>;
<a name="l00579"></a>00579 }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 } <span class="comment">// C extern</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 9 2012 22:25:08 for libvisual by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
